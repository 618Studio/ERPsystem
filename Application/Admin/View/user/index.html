<!DOCTYPE html>
<html lang="en">
<head>
    <!-- BEGIN META -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Olive Enterprise">
    <!-- END META -->

    <!-- BEGIN SHORTCUT ICON -->
    <link rel="shortcut icon" href="__ROOT__/Public/img/favicon.ico">
    <!-- END SHORTCUT ICON -->
    <title>
        Advanced Form Components
    </title>

    <!-- BEGIN STYLESHEET -->

    <link href="__ROOT__/Public/css/bootstrap.min.css" rel="stylesheet"><!-- BOOTSTRAP CSS -->
    <link href="__ROOT__/Public/css/bootstrap-reset.css" rel="stylesheet"><!-- BOOTSTRAP CSS -->

    <link href="__ROOT__/Public/assets/font-awesome/css/font-awesome.css" rel="stylesheet"><!-- FONT AWESOME ICON STYLESHEET -->
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/assets/bootstrap-wysihtml5/bootstrap-wysihtml5.css"><!-- BOOTSTRAP WYSIHTML5 PLUGIN CSS -->
    <link rel="stylesheet" type="text/css" href="__ROOT__/Public/assets/jquery-multi-select/css/multi-select.css"><!-- JQUERY MULTI SELECT PLUGIN CSS -->
    <link rel="stylesheet" href="__ROOT__/Public/assets/data-tables/DT_bootstrap.css"><!-- DATATABLE CSS -->
    <link href="__ROOT__/Public/css/style.css" rel="stylesheet"><!-- THEME BASIC CSS -->
    <link href="__ROOT__/Public/css/style-responsive.css" rel="stylesheet"><!-- THEME BASIC RESPONSIVE  CSS -->

    <!--[if lt IE 9]>
    <script src="__ROOT__/Public/js/html5shiv.js">
    </script>
    <script src="__ROOT__/Public/js/respond.min.js">
    </script>
    <![endif]-->
    <!-- END STYLESHEET -->

</head>
<body>
<!-- BEGIN SECTION -->

<section id="container" class="">
    <!-- BEGIN HEADER -->

    <header class="header white-bg">

        <!-- SIDEBAR TOGGLE BUTTON -->
        <div class="sidebar-toggle-box">
            <div  data-placement="right" class="fa fa-bars tooltips">
            </div>
        </div>
        <!-- SIDEBAR TOGGLE BUTTON  END-->
        <a href="index.html" class="logo">
            olive
          <span>
            admin
          </span>
        </a>

        <!-- START HEADER  NAV -->

        <nav class="nav notify-row" id="top_menu">

            <ul class="nav top-menu">
                <!-- START NOTIFY TASK BAR -->

                <li class="dropdown">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                        <i class="fa fa-tasks">
                        </i>
                <span class="badge bg-success">
                  6
                </span>
                    </a>

                    <ul class="dropdown-menu extended tasks-bar">
                        <li class="notify-arrow notify-arrow-blue">
                        </li>
                        <li>
                            <p class="blue">
                                You have 6 pending tasks
                            </p>
                        </li>
                        <li>
                            <a href="#">
                                <div class="task-info">
                                    <div class="desc">
                                        Dashboard v1.3
                                    </div>
                                    <div class="percent">
                                        40%
                                    </div>
                                </div>
                                <div class="progress progress-striped">
                                    <div class="progress-bar progress-bar-success set-40" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" >
                        <span class="sr-only">
                          40% Complete (success)
                        </span>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <div class="task-info">
                                    <div class="desc">
                                        Database Update
                                    </div>
                                    <div class="percent">
                                        60%
                                    </div>
                                </div>
                                <div class="progress progress-striped">
                                    <div class="progress-bar progress-bar-warning set-60" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" >
                        <span class="sr-only">
                          60% Complete (warning)
                        </span>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <div class="task-info">
                                    <div class="desc">
                                        Iphone Development
                                    </div>
                                    <div class="percent">
                                        87%
                                    </div>
                                </div>
                                <div class="progress progress-striped">
                                    <div class="progress-bar progress-bar-info set-87" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" >
                        <span class="sr-only">
                          87% Complete
                        </span>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <div class="task-info">
                                    <div class="desc">
                                        Mobile App
                                    </div>
                                    <div class="percent">
                                        33%
                                    </div>
                                </div>
                                <div class="progress progress-striped">
                                    <div class="progress-bar progress-bar-danger set-33" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" >
                        <span class="sr-only">
                          33% Complete (danger)
                        </span>
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <div class="task-info">
                                    <div class="desc">
                                        Dashboard v1.3
                                    </div>
                                    <div class="percent">
                                        45%
                                    </div>
                                </div>
                                <div class="progress progress-striped active">
                                    <div class="progress-bar set-45" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" >
                        <span class="sr-only">
                          45% Complete
                        </span>
                                    </div>

                                </div>
                            </a>
                        </li>
                        <li class="external">
                            <a href="#">
                                See All Tasks
                            </a>
                        </li>
                    </ul>

                </li>
                <!-- END NOTIFY TASK BAR -->

                <!-- START NOTIFY INBOX BAR -->

                <li id="header_inbox_bar" class="dropdown">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                        <i class="fa fa-envelope-o">
                        </i>
                <span class="badge bg-important">
                  5
                </span>
                    </a>
                    <ul class="dropdown-menu extended inbox">
                        <li class="notify-arrow notify-arrow-blue">
                        </li>
                        <li>
                            <p class="blue">
                                You have 5 new messages
                            </p>
                        </li>
                        <li>
                            <a href="#">
                    <span class="photo">
                      <img alt="avatar" src="__ROOT__/Public/img/avatar-mini.jpg">
                    </span>
                    <span class="subject">
                      <span class="from">
                        Chintan Pandya
                      </span>
                      <span class="time">
                        Just now
                      </span>
                    </span>
                    <span class="message">
                      Hello, this is an example msg.
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="photo">
                      <img alt="avatar" src="__ROOT__/Public/img/avatar-mini2.jpg">
                    </span>
                    <span class="subject">
                      <span class="from">
                        Parth Jani
                      </span>
                      <span class="time">
                        10 mins
                      </span>
                    </span>
                    <span class="message">
                      Hi, Bro how are you ?
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="photo">
                      <img alt="avatar" src="__ROOT__/Public/img/avatar-mini3.jpg">
                    </span>
                    <span class="subject">
                      <span class="from">
                        Jay Bardolia
                      </span>
                      <span class="time">
                        3 hrs
                      </span>
                    </span>
                    <span class="message">
                      This is awesome dashboard.
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="photo">
                      <img alt="avatar" src="__ROOT__/Public/img/avatar-mini4.jpg">
                    </span>
                    <span class="subject">
                      <span class="from">
                        Pruthvi Bardolia
                      </span>
                      <span class="time">
                        Just now
                      </span>
                    </span>
                    <span class="message">
                      Hello, this is metrolab
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                See all messages
                            </a>
                        </li>
                    </ul>
                </li>
                <!-- END NOTIFY INBOX BAR -->

                <!-- START NOTIFY NOTIFICATION BAR -->

                <li id="header_notification_bar" class="dropdown">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                        <i class="fa fa-bell-o">
                        </i>
                <span class="badge bg-warning">
                  7
                </span>
                    </a>
                    <ul class="dropdown-menu extended notification">
                        <li class="notify-arrow notify-arrow-blue">
                        </li>
                        <li>
                            <p class="blue">
                                You have 7 new notifications
                            </p>
                        </li>
                        <li>
                            <a href="#">
                    <span class="label label-danger">
                      <i class="fa fa-bolt">
                      </i>
                    </span>
                                Server #3 overloaded.
                    <span class="small italic">
                      34 mins
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="label label-warning">
                      <i class="fa fa-bell">
                      </i>
                    </span>
                                Server #10 not respoding.
                    <span class="small italic">
                      1 Hours
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="label label-danger">
                      <i class="fa fa-bolt">
                      </i>
                    </span>
                                Database overloaded 24%.
                    <span class="small italic">
                      4 hrs
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="label label-success">
                      <i class="fa fa-plus">
                      </i>
                    </span>
                                New user registered.
                    <span class="small italic">
                      Just now
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                    <span class="label label-primary">
                      <i class="fa fa-bullhorn">
                      </i>
                    </span>
                                Application error.
                    <span class="small italic">
                      10 mins
                    </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                See all notifications
                            </a>
                        </li>
                    </ul>
                </li>
                <!-- END NOTIFY NOTIFICATION BAR -->

            </ul>


        </nav>

        <!-- END HEADER NAV -->


        <!-- START USER LOGIN DROPDOWN  -->

        <div class="top-nav ">
            <ul class="nav pull-right top-menu">
                <li>
                    <input type="text" class="form-control search" placeholder="Search">
                </li>

                <li class="dropdown">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                        <img alt="" src="__ROOT__/Public/img/avatar1_small.jpg">
                <span class="username">
                  Pruthvi
                </span>
                        <b class="caret">
                        </b>
                    </a>
                    <ul class="dropdown-menu extended logout">
                        <li class="log-arrow-up">
                        </li>
                        <li>
                            <a href="#">
                                <i class=" fa fa-suitcase">
                                </i>
                                Profile
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fa fa-cog">
                                </i>
                                Settings
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <i class="fa fa-bell-o">
                                </i>
                                Notification
                            </a>
                        </li>
                        <li>
                            <a href="login.html">
                                <i class="fa fa-key">
                                </i>
                                Log Out
                            </a>
                        </li>
                    </ul>
                </li>

            </ul>
        </div>
        <!-- END USER LOGIN DROPDOWN  -->

    </header>
    <!-- END HEADER -->


    <!-- BEGIN SIDEBAR -->
    <include file="./Application/Common/Common/sidebar.html" />
    <!-- END SIDEBAR -->

    <!-- START MAIN CONTENT -->
    <section id="main-content">
        
        <section class="wrapper site-min-height">
            <!-- START ROW -->
            <div class="row">
                <div class="col-md-8">
                    <section class="panel">
                        <header class="panel-heading">
                            <span class="label label-primary">用 户 组</span>
                             <span class="tools pull-right">
                             <a href="javascript:;" class="fa fa-chevron-down"></a>
                             <a href="javascript:;" class="fa fa-times"></a>
                             </span>
                        </header>
                        <div class="panel-body">
                            <div class="adv-table editable-table ">
                                <div class="clearfix">
                                    <div class="btn-group">
                                        <button id="editable-sample_new" class="btn btn-success green">
                                            Add New <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                    <div class="btn-group pull-right">
                                        <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Tools <i class="fa fa-angle-down"></i>
                                        </button>
                                        <ul class="dropdown-menu pull-right">
                                            <li><a href="#">Print</a></li>
                                            <li><a href="#">Save as PDF</a></li>
                                            <li><a href="#">Export to Excel</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="space15"></div>
                                <table class="table table-striped table-hover table-bordered" id="editable-sample">
                                        <thead>
                                        <tr>
                                            <th>群 组 号</th>
                                            <th>群 组 名</th>
                                            <th>编 辑</th>
                                            <th>删 除</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <volist name="group" id="vo">
                                            <tr class="">
                                                <td>{$key}</td>
                                                <td>{$vo}</td>
                                                <td><a class="edit" href="javascript:;" onclick="edit('{$key}','{$vo}')"><span class="label label-success">Edit</span></a></td>
                                                <td><a class="delete" href="javascript:;"><span  n class="label label-danger">Delete</span></a></td>
                                            </tr>
                                        </volist>
                                        </tbody>
                                    </table>

                            </div>
                        </div>
                    </section>
                </div>
                <div class="col-md-4">
                    <section class="panel">
                        <header class="panel-heading">
                            <span class="label label-primary">
                            权 限 编 辑
                            </span>
                            <span class="tools pull-right">
                                <a href="javascript:;" class="fa fa-chevron-down">
                                </a>
                                <a href="javascript:;" class="fa fa-times">
                                </a>
                            </span>
                        </header>
                        <div class="panel-body">
                            <div style="padding-bottom: 30px"></div>
                            <form action="#" class="form-horizontal tasi-form">

                                <div class="form-group last">

                                    <div class="col-md-10 col-md-offset-1">
                                        <select name="country" class="multi-select" multiple="" id="my_multi_select3">


                                        </select>
                                    </div>
                                </div>
                            </form>
                            <div style="padding-bottom: 70px"></div>
                        </div>
                        <div class="panel-footer">
                            <h2 class="text-center" id="current_group"></h2>
                        </div>
                    </section>
                </div>
            </div>
            <!-- END ROW -->
            <div class="row"></div>


        </section>
        <!-- START WRAPPER -->
    </section>
    <!-- END MAIN CONTENT -->
    <!-- BEGIN FOOTER -->

    <footer class="site-footer">
        <div class="text-center">
            2013 &copy; Olive Admin by
            <a href="" target="_blank">
                Olive Enterprise
            </a>
            <a href="http://www.mycodes.net" class="go-top">
                <i class="fa fa-angle-up">
                </i>
            </a>
        </div>
    </footer>
    <!-- END FOOTER --> 

</section>
<!-- END SECTION -->


<!-- BEGIN JS -->

<script src="__ROOT__/Public/js/jquery-1.8.3.min.js" ></script><!-- BASIC JS LIABRARY 1.8.3 -->
<script src="__ROOT__/Public/js/bootstrap.min.js" ></script><!-- BOOTSTRAP JS  -->
<script src="__ROOT__/Public/js/jquery.dcjqaccordion.2.7.js"></script><!-- ACCORDING JS -->
<script src="__ROOT__/Public/js/jquery.scrollTo.min.js" ></script><!-- SCROLLTO JS  -->
<script src="__ROOT__/Public/js/jquery.nicescroll.js" > </script><!-- NICESCROLL JS  -->
<script src="__ROOT__/Public/js/respond.min.js" ></script><!-- RESPOND JS  -->
<script src="__ROOT__/Public/assets/jquery-multi-select/js/jquery.multi-select.js"></script><!-- BOOTSTRAP MULTISELECT JS  -->
<script src="__ROOT__/Public/assets/jquery-multi-select/js/jquery.quicksearch.js"></script><!-- BOOTSTRAP MULTISELECT JS  -->
<script src="__ROOT__/Public/assets/data-tables/jquery.dataTables.js"></script><!-- DATATABLE JS  -->
<script src="__ROOT__/Public/assets/data-tables/DT_bootstrap.js"></script><!-- DATATABLE JS  -->
<script src="__ROOT__/Public/js/common-scripts.js" ></script><!-- BASIC COMMON JS  -->
<!-- END JS -->
<script>

    var privilege = {
        gOrderQ: "订单查询",
        gOrderE: "订单编辑",
        gMaterialsQ: "物资查询",
        gMaterialsE: "物资编辑",
        gStockQ: "库存查询",
        gStockE: "库存编辑",
        gWorkScheQ: "生产计划查询",
        gWorkScheE: "生产计划编辑",
        gGalQ: "镀铝锌查询",
        gGalE: "镀铝锌编辑",
        gColorQ: "彩涂生产查询",
        gColorE: "彩涂生产编辑",
        gCostQ: "成本查询",
        gCostE: "成本编辑",
        gQualityQ: "质量查询",
        gQualityE: "质量编辑",
        gUserQ: "用户管理",
        gUserE: "用户查询"
    };

    $('#my_multi_select3').multiSelect({
        selectableHeader: "<input type='text' class='form-control search-input' autocomplete='off' placeholder='搜索...'>",
        selectionHeader: "<input type='text' class='form-control search-input' autocomplete='off' placeholder='搜索...'>",
        afterInit: function (ms) {
            var that = this,
                    $selectableSearch = that.$selectableUl.prev(),
                    $selectionSearch = that.$selectionUl.prev(),
                    selectableSearchString = '#' + that.$container.attr('id') + ' .ms-elem-selectable:not(.ms-selected)',
                    selectionSearchString = '#' + that.$container.attr('id') + ' .ms-elem-selection.ms-selected';
            that.qs1 = $selectableSearch.quicksearch(selectableSearchString).on('keydown', function (e) {
                if (e.which === 40) {
                    that.$selectableUl.focus();
                    return false;
                }
            });
            that.qs2 = $selectionSearch.quicksearch(selectionSearchString).on('keydown', function (e) {
                if (e.which == 40) {
                    that.$selectionUl.focus();
                    return false;
                }
            });
        },
        afterSelect: function () {
            this.qs1.cache();
            this.qs2.cache();
        },
        afterDeselect: function () {
            this.qs1.cache();
            this.qs2.cache();
        },
        selectableFooter: "<h4 style='text-align: center'>拥有权限</h4>",
        selectionFooter: "<h4 style='text-align: center'>可选权限</h4>"

    });

    var EditableTable = function () {

        'use strict';

        return {
            init: function () {
                function restoreRow(oTable, nRow) {
                    var aData = oTable.fnGetData(nRow);
                    var jqTds = $('>td', nRow);
                    for (var i = 0, iLen = jqTds.length; i < iLen; i++) {
                        oTable.fnUpdate(aData[i], nRow, i, false);
                    }
                    oTable.fnDraw();
                }

                function editRow(oTable, nRow) {
                    var aData = oTable.fnGetData(nRow);
                    var jqTds = $('>td', nRow);
                    jqTds[0].innerHTML = '<input type="text" class="form-control small" value="' + aData[0] + '" disabled>';
                    jqTds[1].innerHTML = '<input type="text" class="form-control small" value="' + aData[1] + '">';
                    jqTds[2].innerHTML = '<a class="save" href=""><span class="label label-primary">Save</span></a>';
                    jqTds[3].innerHTML = '<a class="cancel" href=""><span class="label label-info">Cancel</span></a>';
                }

                function saveRow(oTable, nRow) {
                    var jqInputs = $('input', nRow);
                    oTable.fnUpdate(jqInputs[0].value, nRow, 0, false);
                    oTable.fnUpdate(jqInputs[1].value, nRow, 1, false);
                    oTable.fnUpdate('<a class="edit" href=""><span class="label label-success">Edit</span></a>', nRow, 2, false);
                    oTable.fnUpdate('<a class="delete" href=""><span class="label label-danger">Delete</span></a>', nRow, 3, false);
                    oTable.fnDraw();
                }

                function cancelEditRow(oTable, nRow) {
                    var jqInputs = $('input', nRow);
                    oTable.fnUpdate(jqInputs[0].value, nRow, 0, false);
                    oTable.fnUpdate(jqInputs[1].value, nRow, 1, false);
                    oTable.fnUpdate('<a class="edit" href="">Edit</a>', nRow, 4, false);
                    oTable.fnDraw();
                }

                var oTable = $('#editable-sample').dataTable({
                    autoWidth : true,
                    "aLengthMenu": [
                        [5, 15, 20, -1],
                        [5, 15, 20, "All"]
                    ],
                    "iDisplayLength": 5,
                    "sDom": "<'row'<'col-lg-6'l><'col-lg-6'f>r><'table-responsive' t><'row'<'col-lg-6'i><'col-lg-6'p>>",
                    "sPaginationType": "bootstrap",
                    "oLanguage": {
                        "sProcessing": "正在加载中......",
                        "sLengthMenu": "每页显示 _MENU_ 条记录",
                        "sZeroRecords": "对不起，查询不到相关数据！",
                        "sEmptyTable": "表中无数据存在！",
                        "sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录",
                        "sInfoFiltered": "数据表中共为 _MAX_ 条记录",
                        "sSearch": "搜索",
                        "oPaginate": {
                            "sFirst": "首页",
                            "sPrevious": "上一页",
                            "sNext": "下一页",
                            "sLast": "末页"
                        }
                    },
                    "aoColumnDefs": [{
                        'bSortable': true,
                        'aTargets': [0]
                    }]
                });
                jQuery('#editable-sample_wrapper .dataTables_filter input').addClass("form-control medium");
                jQuery('#editable-sample_wrapper .dataTables_length select').addClass("form-control xsmall");
                var nEditing = null;
                $('#editable-sample_new').click(function (e) {
                    e.preventDefault();
                    var aiNew = oTable.fnAddData(['', '', '<a class="edit" href="">Edit</a>', '<a class="cancel" data-mode="new" href="">Cancel</a>']);
                    var nRow = oTable.fnGetNodes(aiNew[0]);
                    var aData = oTable.fnGetData(nRow);
                    var jqTds = $('>td', nRow);
                    jqTds[0].innerHTML = '<input type="text" class="form-control small" value="' + aData[0] + '">';
                    jqTds[1].innerHTML = '<input type="text" class="form-control small" value="' + aData[1] + '">';
                    jqTds[2].innerHTML = '<a class="save" href="" data-mode="new"><span class="label label-primary">Save</span></a>';
                    jqTds[3].innerHTML = '<a class="cancel" href="" data-mode="new"><span class="label label-info">Cancel</span></a>';
                    nEditing = nRow;

                    for(var each  in privilege){
                        var obj = {};
                        obj.text = privilege[each];
                        obj.value = each;
                        $('#my_multi_select3').multiSelect("addOption",obj);
                    }
                    $('#current_group').empty();
                    $('#current_group').append("<small >正 在 新 增 群 组</small>");
                });
                $('#editable-sample a.delete').live('click', function (e) {
                    e.preventDefault();
                    if (confirm("Are you sure to delete this row ?") == false) {
                        return;
                    }
                    var nRow = $(this).parents('tr')[0];
                    var jqInputs = $('td',nRow);
                    $.post("{:U('admin/group/delete')}",{
                                gId :jqInputs[0].innerHTML
                            },
                            function(data){
                                if(data['result']==1){
                                    alert("修改成功！");
                                    oTable.fnDeleteRow(nRow);
                                }
                                else if(data['result']==0){
                                    alert("修改失败！");
                                }
                            })
                });
                $('#editable-sample a.cancel').live('click', function (e) {
                    e.preventDefault();
                    if ($(this).attr("data-mode") == "new") {
                        var nRow = $(this).parents('tr')[0];
                        oTable.fnDeleteRow(nRow);
                        $('#my_multi_select3').empty();
                        $('.ms-list').empty();
                        $('#current_group').empty();
                    } else {
                        restoreRow(oTable, nEditing);
                        nEditing = null;
                        $('#my_multi_select3').empty();
                        $('.ms-list').empty();
                        $('#current_group').empty();
                    }
                });
                $('#editable-sample a.edit').live('click', function (e) {
                    e.preventDefault();
                    var nRow = $(this).parents('tr')[0];
                    if (nEditing !== null && nEditing != nRow) {
                        restoreRow(oTable, nEditing);
                        editRow(oTable, nRow);
                        nEditing = nRow;
                    } else {
                        editRow(oTable, nRow);
                        nEditing = nRow;
                    }
                });
                $('#editable-sample a.save').live('click', function (e) {
                    e.preventDefault();
                    var nRow = $(this).parents('tr')[0];
                    var jqInputs = $('input', nRow);
                    var arr = $('#my_multi_select3').val();
                    var privilege = {
                        gOrderQ: 0,
                        gOrderE: 0,
                        gMaterialsQ: 0,
                        gMaterialsE: 0,
                        gStockQ: 0,
                        gStockE: 0,
                        gWorkScheQ: 0,
                        gWorkScheE: 0,
                        gGalQ: 0,
                        gGalE: 0,
                        gColorQ: 0,
                        gColorE: 0,
                        gCostQ: 0,
                        gCostE: 0,
                        gQualityQ: 0,
                        gQualityE: 0,
                        gUserQ: 0,
                        gUserE: 0
                    }
                    for(var data in arr)
                    {
                        privilege[arr[data]] = 1;
                    }
                    //增加
                    if ($(this).attr("data-mode") == "new"){
                        $.post("{:U('admin/group/add')}",{
                                    gId: jqInputs[0].value,
                                    group_name: jqInputs[1].value,
                                    gOrderQ: privilege['gOrderQ'],
                                    gOrderE: privilege['gOrderE'],
                                    gMaterialsQ: privilege['gMaterialsQ'],
                                    gMaterialsE: privilege['gMaterialsE'],
                                    gStockQ: privilege['gStockQ'],
                                    gStockE: privilege['gStockE'],
                                    gWorkScheQ: privilege['gWorkScheQ'],
                                    gWorkScheE: privilege['gWorkScheE'],
                                    gGalQ: privilege['gGalQ'],
                                    gGalE: privilege['gGalE'],
                                    gColorQ: privilege['gColorQ'],
                                    gColorE: privilege['gColorE'],
                                    gCostQ: privilege['gCostQ'],
                                    gCostE: privilege['gCostE'],
                                    gQualityQ: privilege['gQualityQ'],
                                    gQualityE: privilege['gQualityE'],
                                    gUserQ: privilege['gUserQ'],
                                    gUserE: privilege['gUserE'],
                                },
                                function(data){
                                    if(data['result']==true){
                                        nEditing = nRow;
                                        oTable.fnUpdate(jqInputs[0].value, nRow, 0, false);
                                        oTable.fnUpdate(jqInputs[1].value, nRow, 1, false);
                                        oTable.fnUpdate('<a class="edit" href=""><span class="label label-success">Edit</span></a>', nRow, 2, false);
                                        oTable.fnUpdate('<a class="delete" href=""><span class="label label-danger">Delete</span></a>', nRow, 3, false);
                                        restoreRow(oTable, nEditing);
                                        nEditing = null;
                                        $('#my_multi_select3').empty();
                                        $('.ms-list').empty();
                                        $('#current_group').empty();
                                        alert("增加成功！");
                                    }
                                    else if(data['result']==false){
                                        alert("增加失败！");
                                    }

                                });
                    }
                    else{
                        //修改
                        $.post("{:U('admin/group/edit')}",{
                                    gId: jqInputs[0].value,
                                    group_name: jqInputs[1].value,
                                    gOrderQ: privilege['gOrderQ'],
                                    gOrderE: privilege['gOrderE'],
                                    gMaterialsQ: privilege['gMaterialsQ'],
                                    gMaterialsE: privilege['gMaterialsE'],
                                    gStockQ: privilege['gStockQ'],
                                    gStockE: privilege['gStockE'],
                                    gWorkScheQ: privilege['gWorkScheQ'],
                                    gWorkScheE: privilege['gWorkScheE'],
                                    gGalQ: privilege['gGalQ'],
                                    gGalE: privilege['gGalE'],
                                    gColorQ: privilege['gColorQ'],
                                    gColorE: privilege['gColorE'],
                                    gCostQ: privilege['gCostQ'],
                                    gCostE: privilege['gCostE'],
                                    gQualityQ: privilege['gQualityQ'],
                                    gQualityE: privilege['gQualityE'],
                                    gUserQ: privilege['gUserQ'],
                                    gUserE: privilege['gUserE'],
                                },
                                function(data){
                                    if(data['result']==true){
                                        nEditing = nRow;
                                        oTable.fnUpdate(jqInputs[0].value, nRow, 0, false);
                                        oTable.fnUpdate(jqInputs[1].value, nRow, 1, false);
                                        restoreRow(oTable, nEditing);
                                        nEditing = null;
                                        alert("修改成功！");
                                    }
                                    else if(data['result']==false){
                                        alert("修改失败！");
                                    }

                                });
                    }

                });
            }
        };
    }();




    <!-- EDITABLE TABLE FUNCTION  -->
    jQuery(document).ready(function() {
        EditableTable.init();
    });
    function edit(gid,gname){
        $.post("{:U('Admin/Group/getprivilege')}",
                {
                    "id":gid
                },
                function(data){
                    $('#current_group').empty();
                    $('#current_group').append("<small >正 在 编 辑</small> "+ gname +" <small>群 组</small>");

                    var select = [];
                    var deselect = [];
                    for(pri in data){
                        if(data[pri] == 1){
                            var obj = {};
                            obj.text = privilege[pri];
                            obj.value = pri;
                            select.push(obj);
                            $('#my_multi_select3').multiSelect("addOption",obj);
                            $('#my_multi_select3').multiSelect("select",pri);
                        }
                        else if(data[pri] == 0){
                            obj = {};
                            obj.text = privilege[pri];
                            obj.value = pri;
                            deselect.push(obj);
                            $('#my_multi_select3').multiSelect("addOption",obj);
                            $('#my_multi_select3').multiSelect("deselect",pri);
                        }
                    }

                }
        );
    }
</script>

</body>
</html>

